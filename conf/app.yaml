app:
  name: orphan-studio
  env: dev
  log_level: INFO
  api:
    host: 0.0.0.0
    port: 8000
    workers: 1
    cors_origins:
      - "*"

security:
  jwt_secret: "CHANGE_ME_IN_ENV"
  jwt_algorithm: HS256
  token_ttl_minutes: 120

audit:
  enabled: true
  sink: "file"
  path: "out/audit.log"

model_runtime:
  spm_model: "out/tokenizer/orph_spm.model"
  sft_checkpoint: "out/sft_orphgpt/sft_step_1000.pt"  # <-- set to an existing .pt file
  max_seq_len: 1024
  max_new_tokens: 256
  temperature: 0.8
  top_p: 0.9
  persona: "doctor"

rag:
  index_path: "out/rag/index.pkl"      # where the TF-IDF index lives
  top_k: 5                              # passages to stuff into the prompt
  max_ctx_chars: 600                    # truncate each passage
  source_globs:
    - "data/canonical/canonical*.jsonl"
  include_types: ["drug_label","trial","article"]
  section_keys:                         # which sections to consider when building passages
    - "sections.indications"
    - "sections.dosage"
    - "sections.contraindications"
    - "sections.warnings"
    - "sections.adverse_reactions"
    - "sections.interactions"
    - "sections.patient_information"
    - "sections.storage_and_handling"
    - "sections.body"
  chunk:
    max_len: 900                        # ~ tokens-ish; characters are fine for TF-IDF
    overlap: 120
